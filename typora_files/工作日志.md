~~PDU打通及硬重启测试~~

~~工装测试文档优化及上传。~~

~~make_burn.sh的代码修改上传。~~

~~偶发出现断流问题~~

~~放大系数导致重影问题修复->打包并测试->发邮件更新BOM~~~~

~~移植agv_3g_base的V4.1分支到agv_4g_base~~

~~掉电日志问题优化跟进~~

~~眼图~~->等待实验室回复

R318 isp环境搭建

sensor寄存器同步在R349上的修改(需要处理)audio_dec执行时间过长

BIST环境搭建--》测试方案准备

外置sensor驱动评审单的后续优化及提交

重新进行软重启和硬重启测试

设备上的sensor设备节点先后顺序替换及其在/dev/video节点上变化

申请网线

笔记本网卡修复

python脚本导出



2023/04/28 工作：

报strip file format error--->把两个库替换为新工具链的，其他暂时保持不变

启动报libc.so.6报GLIBC_2.34不符合--->把libc.so.6也尝试替换为新工具链的

发现libc.so.6是软连接，复制一个实体libc.so.6过去，效果无效--->删除了libc.so.6软链接以及实体，然后拷贝过去了libc.so.6实体。

帅帅建议：先把库都替换了，再解决当前问题，看起来仍是：“Failed to execute /init (error -2)”



2023/05/05工作：

~~王工调焦->楼下测试对比~~->50块板子的进度->~~邮件各方沟通->发送邮件~~

~~手里R349是否开启降噪->关闭降噪->R349与R318一致性分析~~

~~打通新SDK下载->打通docker创建->确认相关信息（尤其是SDK确认）->repo回退版本~~->打通编译流程

~~在redmine上申请8.5版本tuner支持~~



rk3588_linux_release_v1.0.3_20220920.xml

.repo/manifests/rk3588_linux/rk3588_linux_release_v1.0.3_20220920.xml

![image-20230506165956806](Y:\github_local\notebook\typora_files\工作日志.assets\image-20230506165956806.png)

```shell
repo init --repo-url ssh://git@www.rockchip.com.cn/repo/rk/tools/repo -u ssh://git@www.rockchip.com.cn/linux/rockchip/platform/manifests -b linux -m rk3588_linux_release.xml
```



2023/05/07工作：

更新外置sensor的bsp程序，

更新sc130gs的寄存器配置，

打通编译流程

```shell
build.sh rootfs
```

2023/05/09工作：

分析MIPI CLK降频为什么导致ISP模块报一下错误

i.	<3>[   73.958799] rkisp0-vir0: CIF_ISP_PIC_SIZE_ERROR (0x00000001)
ii.	<3>[   73.970399] rkcif-mipi-lvds4: ERROR: csi size err, intstat:0x1000000, lastline:0!!

FPD-LINK文档(mipi接入)

- 选的是：CSI-2 Synchronous Mode--》954上的REFCLK--》各CLK计算公式，包括CLKOUT
- HS_CLK_DIV=4, M=1,N=40，所以CLK_OUT是25MHZ
- FPD-LINK的速率是由谁来控制的？

- 示波器要看：MIPI CLK的帧率、953的CLKOUT、SENSOR的PIXCLK、
- 确定一下集成sensor的帧率->60/70/80可以，90/100帧率减半。

- ![image-20230509135155249](Y:\github_local\notebook\typora_files\工作日志.assets\image-20230509135155249.png)

**打通rootfs的编译**

- brmake->启动make， 发现make没有，发现config不对。
- （rv1126）Makefile -> buildroot/build/Makefile
- 如何看sdk版本：（rk3588 自有sdk）rk3588_linux_release.xml -> rk3588_linux/rk3588_linux_release_v1.0.3_20220920.xml
- （rk3588 repo）buildroot linux-5.10-gen-rkr4

![image-20230509113600418](Y:\github_local\notebook\typora_files\工作日志.assets\image-20230509113600418.png)

V1.0.3的SDK版本：e165ea3749247205da7407d5753c46b2d6a47629

sensor测试环境

| 参数值     | 裸板  | 裸板  | 有镜头框 | 有镜头框                         |
| ---------- | ----- | ----- | -------- | -------------------------------- |
| 距离       | 13cm  | 30cm  | 30cm     | 13cm(最大13，再大识别失败率大增) |
| 曝光       | 30    | 50    | 300      | 100                              |
| 增益       | 1     | 5     | 8        | 8                                |
| 放大系数   | 1     | 2.5   | 2.5      | 1                                |
| 二维码直径 | 3.5cm | 3.5cm | 3.5cm    | 3.5cm                            |



|      | 外置sensor现有问题                                           | 优先级 | 细致描述              |
| ---- | ------------------------------------------------------------ | ------ | --------------------- |
| 1    | csi size error对应丢帧                                       |        |                       |
| 2    | libmpp取流有50ms取不到的情况（目前认为是丢帧过多，或者说“断流”了） |        | 目前认为同1是一个问题 |
| 3    | （外在）启动频闪问题及（内在）pwdn多次拉高拉低问题           | 高     |                       |
| 4    | 信号质量功能开发                                             | 高     |                       |
| 5    | 驱动里的电源使能到底在使能什么？                             | 中     |                       |
| 6    | 为什么上电时pwdn有一个异常情况                               | 中     |                       |
| 7    | libmpp从count0一直失败的问题                                 | 高     |                       |
|      |                                                              |        |                       |
|      |                                                              |        |                       |

__sc130gs_953_954_power_on做的工作：

- 953、954寄存器配置
- 写pwdn寄存器 1
- regulator_bulk_enable
- 写pwdn寄存器 0

__sc130gs_953_954_power_on



- sc130gs_953_954_probe
- 





要在r318_dsp中同步修改的问题

![image-20230411105739953](E:\typora_files\工作日志.assets\image-20230411105739953.png)

dev_id的问题





（移植agv_3g_base的V4.1分支到agv_4g_base）没有移植的功能：

- 动态库的打印回调（暂时不移动）

- [CHG]修改增益寄存器，将bit[2]置0，与读码头增益设置方法保持一致

- isp gamma校正
- sensor兼容
